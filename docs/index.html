<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Copula-Based Joint Distribution Modules for simdata • simdatacopulas</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Copula-Based Joint Distribution Modules for simdata">
<meta property="og:description" content="Extends simdata with copula-based joint distribution generators via simdesign templates.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">simdatacopulas</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Archimedean.html">Archimedean Copula → TrialSimulator：端到端示例（Gumbel）</a>
    </li>
    <li>
      <a href="articles/Elliptical.html">Elliptical Copula → TrialSimulator：端到端示例（Gaussian）</a>
    </li>
    <li>
      <a href="articles/Empirical.html">Empirical Copula → TrialSimulator：端到端示例（Rank Resampling）</a>
    </li>
    <li>
      <a href="articles/Factor.html">Factor Copula → TrialSimulator：端到端示例（Factor Gaussian Copula）</a>
    </li>
    <li>
      <a href="articles/Vine.html">Vine Copula → TrialSimulator：端到端示例（R-vine）</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="simdatacopulas">simdatacopulas<a class="anchor" aria-label="anchor" href="#simdatacopulas"></a>
</h1></div>
<p><code>simdatacopulas</code> 是对 <code>simdata</code> 的扩展：把不同类型的 copula（依赖结构）封装为 <code><a href="https://matherealize.github.io/simdata/reference/simdesign.html" class="external-link">simdata::simdesign()</a></code> 模板对象，从而可以用统一的方式生成“边缘分布任意 + 相关结构可控”的多变量数据。</p>
<p>本包的核心思想是两步：</p>
<ol style="list-style-type: decimal">
<li>用某个 copula 生成相关的 (U(0,1)^d)（联合依赖结构）</li>
<li>对每一列 (U_j) 施加边缘分位数函数 <code>dist[[j]](u)</code>，把 (U) 映射到你真正想要的变量尺度（边缘分布）</li>
</ol>
<p>因此 copula 负责“相关/尾部依赖/高维结构”，边缘分位数函数负责“单变量分布形状（连续/离散/截断等）”。</p>
<hr>
<div class="section level2">
<h2 id="安装与依赖">安装与依赖<a class="anchor" aria-label="anchor" href="#%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BE%9D%E8%B5%96"></a>
</h2>
<ul>
<li>运行依赖：<code>simdata</code>、<code>copula</code>
</li>
<li>可选依赖：<code>VineCopula</code>（仅 vine copula 系列需要）</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="快速上手通用工作流">快速上手（通用工作流）<a class="anchor" aria-label="anchor" href="#%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E9%80%9A%E7%94%A8%E5%B7%A5%E4%BD%9C%E6%B5%81"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://matherealize.github.io/simdata/" class="external-link">simdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">simdatacopulas</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">u</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">qexp</a></span><span class="op">(</span><span class="va">u</span>, rate <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">qbeta</a></span><span class="op">(</span><span class="va">u</span>, <span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">simdesign_gaussian_copula</span><span class="op">(</span></span>
<span>  dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>  dim <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  rho <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  names_final <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"t"</span>, <span class="st">"b"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://matherealize.github.io/simdata/reference/simulate_data.html" class="external-link">simulate_data</a></span><span class="op">(</span><span class="va">design</span>, n_obs <span class="op">=</span> <span class="fl">1000</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="模型总览每类-copula-的具体作用">模型总览（每类 copula 的“具体作用”）<a class="anchor" aria-label="anchor" href="#%E6%A8%A1%E5%9E%8B%E6%80%BB%E8%A7%88%E6%AF%8F%E7%B1%BB-copula-%E7%9A%84%E5%85%B7%E4%BD%93%E4%BD%9C%E7%94%A8"></a>
</h2>
<p>本包目前提供 6 组联合生成模块：</p>
<ul>
<li>椭圆族 copula：<code>simdesign_elliptical_copula()</code> / <code>simdesign_gaussian_copula()</code> / <code>simdesign_elliptical_copula_from_data()</code>
</li>
<li>阿基米德 copula：<code>simdesign_archimedean_copula()</code> 及 Clayton/Gumbel/Frank/Joe 的便捷构造器与 <code>*_from_data()</code>
</li>
<li>Vine copula（pair-copula construction）：<code>simdesign_vine_copula()</code> / <code>simdesign_vine_copula_from_data()</code>
</li>
<li>经验 copula（重采样联合秩结构）：<code>simdesign_empirical_copula()</code> / <code>simdesign_empirical_copula_from_data()</code>
</li>
<li>因子 copula（低秩依赖，适合高维）：<code>simdesign_factor_copula()</code> / <code>simdesign_factor_copula_from_data()</code>
</li>
<li>潜变量阈值高斯模型（离散/等级终点联合生成）：<code>simdesign_latent_threshold_gaussian()</code> / <code>simdesign_latent_threshold_gaussian_from_data()</code>
</li>
</ul>
<p>下面逐一说明每个模型的作用、适用场景与用法示例。</p>
<hr>
</div>
<div class="section level2">
<h2 id="id_1-椭圆族-copulagaussian--t">1) 椭圆族 copula（Gaussian / t）<a class="anchor" aria-label="anchor" href="#id_1-%E6%A4%AD%E5%9C%86%E6%97%8F-copulagaussian--t"></a>
</h2>
<div class="section level3">
<h3 id="作用">作用<a class="anchor" aria-label="anchor" href="#%E4%BD%9C%E7%94%A8"></a>
</h3>
<ul>
<li>用“相关矩阵（或交换相关系数）”定义依赖结构，适合模拟<strong>线性相关/对称依赖</strong>的多变量终点。</li>
<li>
<code>Gaussian copula</code> 适用于“相关结构主要由相关系数刻画”的场景。</li>
<li>
<code>t copula</code> 在高斯基础上增加自由度（<code>df</code>），能表达更强的<strong>尾部相关</strong>（极端事件同步出现的概率更大）。</li>
</ul>
</div>
<div class="section level3">
<h3 id="何时用">何时用<a class="anchor" aria-label="anchor" href="#%E4%BD%95%E6%97%B6%E7%94%A8"></a>
</h3>
<ul>
<li>你有目标相关矩阵（或想要交换相关结构），希望把多终点（如 PFS、OS、ORR 连续评分等）关联起来。</li>
<li>维度中等、结构不复杂，或希望先用一个稳健的“基线依赖结构”。</li>
</ul>
</div>
<div class="section level3">
<h3 id="关键接口">关键接口<a class="anchor" aria-label="anchor" href="#%E5%85%B3%E9%94%AE%E6%8E%A5%E5%8F%A3"></a>
</h3>
<ul>
<li>
<code>simdesign_elliptical_copula(copula, dist, ...)</code>：传入 <code><a href="https://rdrr.io/pkg/copula/man/ellipCopula.html" class="external-link">copula::normalCopula()</a></code> 或 <code><a href="https://rdrr.io/pkg/copula/man/ellipCopula.html" class="external-link">copula::tCopula()</a></code> 等对象</li>
<li>
<code>simdesign_gaussian_copula(dist, structure = "ex"/"un", ...)</code>：高斯 copula 便捷入口</li>
<li>
<code>simdesign_elliptical_copula_from_data(data, vars, family = "gaussian"/"t", ...)</code>：从数据拟合依赖结构，边缘默认用经验分位数</li>
</ul>
</div>
<div class="section level3">
<h3 id="示例从数据拟合-gaussian-copula">示例：从数据拟合 Gaussian copula<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B%E4%BB%8E%E6%95%B0%E6%8D%AE%E6%8B%9F%E5%90%88-gaussian-copula"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://matherealize.github.io/simdata/" class="external-link">simdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">simdatacopulas</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pilot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  pfs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">0.15</span><span class="op">)</span>,</span>
<span>  os  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">0.10</span><span class="op">)</span>,</span>
<span>  biomarker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">design_fit</span> <span class="op">&lt;-</span> <span class="fu">simdesign_elliptical_copula_from_data</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pilot</span>,</span>
<span>  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pfs"</span>, <span class="st">"os"</span>, <span class="st">"biomarker"</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  structure <span class="op">=</span> <span class="st">"un"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://matherealize.github.io/simdata/reference/simulate_data.html" class="external-link">simulate_data</a></span><span class="op">(</span><span class="va">design_fit</span>, n_obs <span class="op">=</span> <span class="fl">1000</span>, seed <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="id_2-阿基米德-copulaclayton--gumbel--frank--joe">2) 阿基米德 copula（Clayton / Gumbel / Frank / Joe）<a class="anchor" aria-label="anchor" href="#id_2-%E9%98%BF%E5%9F%BA%E7%B1%B3%E5%BE%B7-copulaclayton--gumbel--frank--joe"></a>
</h2>
<div class="section level3">
<h3 id="作用-1">作用<a class="anchor" aria-label="anchor" href="#%E4%BD%9C%E7%94%A8-1"></a>
</h3>
<p>阿基米德 copula 通过一个参数（通常记为 <code>theta</code>）刻画依赖强度，常用于模拟<strong>非对称尾部依赖</strong>：</p>
<ul>
<li>Clayton：<strong>下尾依赖</strong>更强（低值/差结局更容易一起出现）</li>
<li>Gumbel：<strong>上尾依赖</strong>更强（高值/好结局或极端高值更容易一起出现）</li>
<li>Frank：对称依赖、通常<strong>无尾依赖</strong>（中间区域依赖更明显）</li>
<li>Joe：上尾依赖（常比 Gumbel 更“尖锐”）</li>
</ul>
</div>
<div class="section level3">
<h3 id="何时用-1">何时用<a class="anchor" aria-label="anchor" href="#%E4%BD%95%E6%97%B6%E7%94%A8-1"></a>
</h3>
<ul>
<li>你关心“极端事件/尾部事件的联动”，例如严重不良事件与疗效极端反应的同步性。</li>
<li>你希望用少量参数表达依赖（模型更轻、更好控），但仍保留尾部行为差异。</li>
</ul>
</div>
<div class="section level3">
<h3 id="关键接口-1">关键接口<a class="anchor" aria-label="anchor" href="#%E5%85%B3%E9%94%AE%E6%8E%A5%E5%8F%A3-1"></a>
</h3>
<ul>
<li><code>simdesign_archimedean_copula(copula, dist, ...)</code></li>
<li>便捷构造器：<code>simdesign_clayton_copula()</code>、<code>simdesign_gumbel_copula()</code>、<code>simdesign_frank_copula()</code>、<code>simdesign_joe_copula()</code>
</li>
<li>
<code>simdesign_archimedean_copula_from_data(data, vars, family = ..., ...)</code>：从数据拟合 <code>theta</code>（并用经验边缘）</li>
</ul>
</div>
<div class="section level3">
<h3 id="示例用-gumbel-copula-模拟上尾依赖">示例：用 Gumbel copula 模拟“上尾依赖”<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B%E7%94%A8-gumbel-copula-%E6%A8%A1%E6%8B%9F%E4%B8%8A%E5%B0%BE%E4%BE%9D%E8%B5%96"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://matherealize.github.io/simdata/" class="external-link">simdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">simdatacopulas</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">qlnorm</a></span><span class="op">(</span><span class="va">u</span>, meanlog <span class="op">=</span> <span class="fl">0</span>, sdlog <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">qlnorm</a></span><span class="op">(</span><span class="va">u</span>, meanlog <span class="op">=</span> <span class="fl">0.2</span>, sdlog <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">simdesign_gumbel_copula</span><span class="op">(</span></span>
<span>  dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>  theta <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  dim <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  names_final <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"endpoint1"</span>, <span class="st">"endpoint2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://matherealize.github.io/simdata/reference/simulate_data.html" class="external-link">simulate_data</a></span><span class="op">(</span><span class="va">design</span>, n_obs <span class="op">=</span> <span class="fl">2000</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="id_3-vine-copulac-vine--d-vine--r-vine">3) Vine copula（C-vine / D-vine / R-vine）<a class="anchor" aria-label="anchor" href="#id_3-vine-copulac-vine--d-vine--r-vine"></a>
</h2>
<div class="section level3">
<h3 id="作用-2">作用<a class="anchor" aria-label="anchor" href="#%E4%BD%9C%E7%94%A8-2"></a>
</h3>
<p>Vine copula 用“成对 copula 的树结构（pair-copula construction）”来拼接高维依赖结构：</p>
<ul>
<li>在高维下比“一个整体 copula”更灵活：不同变量对可以选择不同家族、不同尾部行为</li>
<li>能表达复杂的条件依赖关系：例如 (X_1) 与 (X_3) 的相关依赖可能主要通过 (X_2) 传递</li>
</ul>
</div>
<div class="section level3">
<h3 id="何时用-2">何时用<a class="anchor" aria-label="anchor" href="#%E4%BD%95%E6%97%B6%E7%94%A8-2"></a>
</h3>
<ul>
<li>维度较高（例如 6+ 个终点/协变量）且你不希望依赖结构被一个单一相关矩阵/单参数限制。</li>
<li>你希望数据驱动地选择 pair-copula 家族（AIC/BIC 等准则）。</li>
</ul>
</div>
<div class="section level3">
<h3 id="依赖说明">依赖说明<a class="anchor" aria-label="anchor" href="#%E4%BE%9D%E8%B5%96%E8%AF%B4%E6%98%8E"></a>
</h3>
<p>Vine 模块依赖 <code>VineCopula</code> 包；未安装时会报错提示安装。</p>
</div>
<div class="section level3">
<h3 id="关键接口-2">关键接口<a class="anchor" aria-label="anchor" href="#%E5%85%B3%E9%94%AE%E6%8E%A5%E5%8F%A3-2"></a>
</h3>
<ul>
<li>
<code>simdesign_vine_copula(vine, dist, ...)</code>：传入 <code>VineCopula</code> 的 vine 对象（如 <code>RVineMatrix</code>）</li>
<li>
<code>simdesign_vine_copula_from_data(data, vars, vine_type = "rvine"/"cvine"/"dvine", ...)</code>：从数据拟合 vine 结构与 pair-copula</li>
</ul>
</div>
<div class="section level3">
<h3 id="示例从数据拟合-r-vine自动结构选择">示例：从数据拟合 R-vine（自动结构选择）<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B%E4%BB%8E%E6%95%B0%E6%8D%AE%E6%8B%9F%E5%90%88-r-vine%E8%87%AA%E5%8A%A8%E7%BB%93%E6%9E%84%E9%80%89%E6%8B%A9"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://matherealize.github.io/simdata/" class="external-link">simdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">simdatacopulas</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pilot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">600</span><span class="op">)</span>,</span>
<span>  x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">600</span><span class="op">)</span>,</span>
<span>  x3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">600</span><span class="op">)</span>,</span>
<span>  x4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">600</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">design_fit</span> <span class="op">&lt;-</span> <span class="fu">simdesign_vine_copula_from_data</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pilot</span>,</span>
<span>  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span><span class="op">)</span>,</span>
<span>  vine_type <span class="op">=</span> <span class="st">"rvine"</span>,</span>
<span>  selectioncrit <span class="op">=</span> <span class="st">"AIC"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"itau"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://matherealize.github.io/simdata/reference/simulate_data.html" class="external-link">simulate_data</a></span><span class="op">(</span><span class="va">design_fit</span>, n_obs <span class="op">=</span> <span class="fl">1000</span>, seed <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="id_4-经验-copulaempirical-copula--rank-resampling">4) 经验 copula（Empirical copula / rank resampling）<a class="anchor" aria-label="anchor" href="#id_4-%E7%BB%8F%E9%AA%8C-copulaempirical-copula--rank-resampling"></a>
</h2>
<div class="section level3">
<h3 id="作用-3">作用<a class="anchor" aria-label="anchor" href="#%E4%BD%9C%E7%94%A8-3"></a>
</h3>
<p>经验 copula 不显式假设某个参数化 copula 家族，而是：</p>
<ul>
<li>从已有样本的 <code>U</code>（伪观测）中<strong>重采样</strong>联合秩结构</li>
<li>结合你指定的边缘分位数函数，生成新样本</li>
</ul>
<p>它的核心价值是：在样本量足够、你相信样本联合秩结构具有代表性时，可以非常直接地“复刻”依赖结构。</p>
</div>
<div class="section level3">
<h3 id="何时用-3">何时用<a class="anchor" aria-label="anchor" href="#%E4%BD%95%E6%97%B6%E7%94%A8-3"></a>
</h3>
<ul>
<li>你有可靠的历史/真实数据，想尽量保留其中的联合依赖结构（尤其是复杂、难以参数化的依赖）。</li>
<li>你想避免 copula 家族选择带来的建模偏差。</li>
</ul>
</div>
<div class="section level3">
<h3 id="注意点">注意点<a class="anchor" aria-label="anchor" href="#%E6%B3%A8%E6%84%8F%E7%82%B9"></a>
</h3>
<ul>
<li>经验 copula 的外推能力有限：它擅长“重现已观察到的依赖”，不擅长“推断未观察到的尾部结构”。</li>
<li>可选 <code>jitter</code> 用于缓解大量 ties 或离散化带来的重复点问题。</li>
</ul>
</div>
<div class="section level3">
<h3 id="关键接口-3">关键接口<a class="anchor" aria-label="anchor" href="#%E5%85%B3%E9%94%AE%E6%8E%A5%E5%8F%A3-3"></a>
</h3>
<ul>
<li><code>simdesign_empirical_copula(u_data, dist, replace = TRUE, jitter = 0, ...)</code></li>
<li>
<code>simdesign_empirical_copula_from_data(data, vars, ...)</code>：自动对数据做 <code>pobs()</code> 得到 <code>u_data</code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="示例直接从数据生成经验-copula-设计">示例：直接从数据生成经验 copula 设计<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B%E7%9B%B4%E6%8E%A5%E4%BB%8E%E6%95%B0%E6%8D%AE%E7%94%9F%E6%88%90%E7%BB%8F%E9%AA%8C-copula-%E8%AE%BE%E8%AE%A1"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://matherealize.github.io/simdata/" class="external-link">simdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">simdatacopulas</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pilot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">800</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">800</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">800</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">design_fit</span> <span class="op">&lt;-</span> <span class="fu">simdesign_empirical_copula_from_data</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pilot</span>,</span>
<span>  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>,</span>
<span>  jitter <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://matherealize.github.io/simdata/reference/simulate_data.html" class="external-link">simulate_data</a></span><span class="op">(</span><span class="va">design_fit</span>, n_obs <span class="op">=</span> <span class="fl">1000</span>, seed <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="id_5-因子-copulafactor-gaussian-copula">5) 因子 copula（Factor Gaussian copula）<a class="anchor" aria-label="anchor" href="#id_5-%E5%9B%A0%E5%AD%90-copulafactor-gaussian-copula"></a>
</h2>
<div class="section level3">
<h3 id="作用-4">作用<a class="anchor" aria-label="anchor" href="#%E4%BD%9C%E7%94%A8-4"></a>
</h3>
<p>因子 copula 用“少数公共因子 + 特异噪声”的结构生成高维相关：</p>
<p>[ Z = F ^+ E,U = (Z) ]</p>
<ul>
<li>()（<code>loadings</code>）控制每个变量对公共因子的敏感度</li>
<li>
<code>uniq_var</code> 控制每个变量的特异方差</li>
</ul>
<p>它相当于把协方差/相关结构限制为“低秩 + 对角”，从而在高维下更稳定、参数更少。</p>
</div>
<div class="section level3">
<h3 id="何时用-4">何时用<a class="anchor" aria-label="anchor" href="#%E4%BD%95%E6%97%B6%E7%94%A8-4"></a>
</h3>
<ul>
<li>维度较高（例如多终点 + 多协变量），你希望用少量参数刻画“整体相关驱动因素”（例如疾病严重程度、暴露量、治疗敏感性等潜因子）。</li>
<li>你需要一个比完整相关矩阵更稳定、更可解释的相关结构。</li>
</ul>
</div>
<div class="section level3">
<h3 id="关键接口-4">关键接口<a class="anchor" aria-label="anchor" href="#%E5%85%B3%E9%94%AE%E6%8E%A5%E5%8F%A3-4"></a>
</h3>
<ul>
<li>
<code>simdesign_factor_copula(loadings, uniq_var, dist, ...)</code>：直接给定因子结构与边缘</li>
<li>
<code>simdesign_factor_copula_from_data(data, vars, n_factors = 1, ...)</code>：先把数据转换为伪观测并映射到高斯空间，再做因子拟合</li>
</ul>
</div>
<div class="section level3">
<h3 id="示例从数据拟合-1-因子-copula">示例：从数据拟合 1 因子 copula<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B%E4%BB%8E%E6%95%B0%E6%8D%AE%E6%8B%9F%E5%90%88-1-%E5%9B%A0%E5%AD%90-copula"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://matherealize.github.io/simdata/" class="external-link">simdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">simdatacopulas</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pilot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">0</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>  x3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">design_fit</span> <span class="op">&lt;-</span> <span class="fu">simdesign_factor_copula_from_data</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pilot</span>,</span>
<span>  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span><span class="op">)</span>,</span>
<span>  n_factors <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://matherealize.github.io/simdata/reference/simulate_data.html" class="external-link">simulate_data</a></span><span class="op">(</span><span class="va">design_fit</span>, n_obs <span class="op">=</span> <span class="fl">1000</span>, seed <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="id_6-潜变量阈值高斯模型latent-threshold-gaussian">6) 潜变量阈值高斯模型（Latent threshold Gaussian）<a class="anchor" aria-label="anchor" href="#id_6-%E6%BD%9C%E5%8F%98%E9%87%8F%E9%98%88%E5%80%BC%E9%AB%98%E6%96%AF%E6%A8%A1%E5%9E%8Blatent-threshold-gaussian"></a>
</h2>
<div class="section level3">
<h3 id="作用-5">作用<a class="anchor" aria-label="anchor" href="#%E4%BD%9C%E7%94%A8-5"></a>
</h3>
<p>该模块用于联合生成<strong>离散/等级终点</strong>（如 AE 分级、ORR 二分类、毒性等级等）：</p>
<ul>
<li>先用因子结构生成连续潜变量 (Z)</li>
<li>每个离散变量通过阈值向量 <code>thresholds[[j]]</code> 把 (Z_j) 切分为 1/2/… 多个等级</li>
<li>可选 <code>levels</code> 为每列指定输出的有序因子标签</li>
</ul>
<p>这类模型的价值是：你能用高斯因子结构（或多元高斯）表达“离散终点之间的相关”，同时保持各离散变量的边缘分布（由阈值决定）。</p>
</div>
<div class="section level3">
<h3 id="何时用-5">何时用<a class="anchor" aria-label="anchor" href="#%E4%BD%95%E6%97%B6%E7%94%A8-5"></a>
</h3>
<ul>
<li>终点包含等级/二分类变量，且你希望它们与其他终点共享潜在相关来源（公共因子）。</li>
<li>你希望显式控制各等级比例（阈值）与等级间相关结构。</li>
</ul>
</div>
<div class="section level3">
<h3 id="关键接口-5">关键接口<a class="anchor" aria-label="anchor" href="#%E5%85%B3%E9%94%AE%E6%8E%A5%E5%8F%A3-5"></a>
</h3>
<ul>
<li><code>simdesign_latent_threshold_gaussian(loadings, uniq_var, thresholds, levels = NULL, ...)</code></li>
<li>
<code>simdesign_latent_threshold_gaussian_from_data(data, vars, n_factors = 1, ...)</code>：
<ul>
<li>自动从每列数据估计阈值（按类别累计概率映射到 <code>qnorm</code> 切点）</li>
<li>将数据转为伪观测并映射到高斯空间后拟合因子结构</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="示例手工指定阈值生成二分类--三分类联合分布">示例：手工指定阈值生成二分类 + 三分类联合分布<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B%E6%89%8B%E5%B7%A5%E6%8C%87%E5%AE%9A%E9%98%88%E5%80%BC%E7%94%9F%E6%88%90%E4%BA%8C%E5%88%86%E7%B1%BB--%E4%B8%89%E5%88%86%E7%B1%BB%E8%81%94%E5%90%88%E5%88%86%E5%B8%83"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://matherealize.github.io/simdata/" class="external-link">simdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">simdatacopulas</span><span class="op">)</span></span>
<span></span>
<span><span class="va">loadings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">uniq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">thresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.30</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.55</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.20</span>, <span class="fl">0.70</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">simdesign_latent_threshold_gaussian</span><span class="op">(</span></span>
<span>  loadings <span class="op">=</span> <span class="va">loadings</span>,</span>
<span>  uniq_var <span class="op">=</span> <span class="va">uniq</span>,</span>
<span>  thresholds <span class="op">=</span> <span class="va">thresholds</span>,</span>
<span>  names_final <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://matherealize.github.io/simdata/reference/simulate_data.html" class="external-link">simulate_data</a></span><span class="op">(</span><span class="va">design</span>, n_obs <span class="op">=</span> <span class="fl">2000</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="与-trialsimulator-的连接方式建议">与 TrialSimulator 的连接方式（建议）<a class="anchor" aria-label="anchor" href="#%E4%B8%8E-trialsimulator-%E7%9A%84%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E5%BB%BA%E8%AE%AE"></a>
</h2>
<p><code>TrialSimulator</code> 对数据生成器的要求是“一个 <code>generator(n)</code> 返回终点列的数据框”。本包返回的是 <code>simdata</code> 的 <code>simdesign</code> 对象，因此你通常会这样桥接：</p>
<ol style="list-style-type: decimal">
<li>用 <code>simdatacopulas::*</code> 构造 <code>design</code>
</li>
<li>用 <code>simdata::simulate_data(design, n_obs = n, seed = ...)</code> 生成一批“联合相关”的基础变量</li>
<li>在 <code>TrialSimulator</code> 的 endpoint generator 内，把这些基础变量映射成 TrialSimulator 需要的终点格式（例如 <code>*_event</code>、删失规则等）</li>
</ol>
<p>这样做的好处是：联合依赖结构与边缘分布建模与试验流程（入组/删失/分析）解耦，便于复用与迭代。</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing simdatacopulas</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Your Name <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Your Name.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
